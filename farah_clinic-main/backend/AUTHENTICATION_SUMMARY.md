# ููุฎุต ูุธุงู ุงููุตุงุฏูุฉ - ุนูุงุฏุฉ ุงูุฏูุชูุฑุฉ ูุฑุญ ุงูุฃุณูุงู

## โ ูุง ุชู ุฅูุฌุงุฒู

### 1. ููุงุฐุฌ ุงููุณุชุฎุฏููู (`models/user.py`)
- **User**: ูููุฐุฌ ุงููุณุชุฎุฏู ุงูุฃุณุงุณู ูุน ุชุดููุฑ ูููุงุช ุงููุฑูุฑ
- **UserCreate**: ูููุฐุฌ ุฅูุดุงุก ูุณุชุฎุฏู ุฌุฏูุฏ
- **UserLogin**: ูููุฐุฌ ุชุณุฌูู ุงูุฏุฎูู
- **UserResponse**: ูููุฐุฌ ุงุณุชุฌุงุจุฉ ุงููุณุชุฎุฏู (ุจุฏูู ูููุฉ ุงููุฑูุฑ)
- **Token**: ูููุฐุฌ JWT Token
- **TokenData**: ุจูุงูุงุช ุงูุฑูุฒ ุงููููุฒ

### 2. ุฎุฏูุฉ ุงููุตุงุฏูุฉ (`services/auth_service.py`)
- ุชุดููุฑ ูููุงุช ุงููุฑูุฑ ุจุงุณุชุฎุฏุงู bcrypt
- ุฅูุดุงุก ูุชุญูู ูู JWT tokens
- ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู (ุฅูุดุงุกุ ุชุญุฏูุซุ ุญุฐู)
- ุฅูุดุงุก ูุฏูุฑ ุงูุชุฑุงุถู
- ุชุญุฏูุซ ุขุฎุฑ ุชุณุฌูู ุฏุฎูู

### 3. Router ุงููุตุงุฏูุฉ (`router/auth_router.py`)
- `POST /auth/register` - ุชุณุฌูู ูุณุชุฎุฏู ุฌุฏูุฏ
- `POST /auth/login` - ุชุณุฌูู ุงูุฏุฎูู
- `GET /auth/me` - ุงูุญุตูู ุนูู ุจูุงูุงุช ุงููุณุชุฎุฏู ุงูุญุงูู
- `POST /auth/refresh` - ุชุฌุฏูุฏ ุงูุฑูุฒ ุงููููุฒ
- `POST /auth/logout` - ุชุณุฌูู ุงูุฎุฑูุฌ
- ุฏูุงู ูุณุงุนุฏุฉ ููุชุญูู ูู ุงููุณุชุฎุฏู ุงูุญุงูู ูุตูุงุญูุงุช ุงููุฏูุฑ

### 4. Middleware ุงูุญูุงูุฉ (`middleware/auth_middleware.py`)
- **AuthMiddleware**: ูุชุญูู ูู ุตุญุฉ Bearer Token
- **AdminMiddleware**: ูุชุญูู ูู ุตูุงุญูุงุช ุงููุฏูุฑ
- ูุนุงูุฌุฉ ุฃุฎุทุงุก ุงููุตุงุฏูุฉ
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ุจุงููุบุฉ ุงูุนุฑุจูุฉ

### 5. ุชุญุฏูุซ Patient Router
- ุฅุถุงูุฉ ุงููุตุงุฏูุฉ ูุฌููุน endpoints
- ุญูุงูุฉ ุฌููุน ุนูููุงุช CRUD ูููุฑุถู
- ุญูุงูุฉ ุนูููุงุช ุงููุฏููุนุงุช ูุงูุฅุญุตุงุฆูุงุช

### 6. ุชุญุฏูุซ Main Application
- ุชุถููู auth router
- ุฅุถุงูุฉ AuthMiddleware
- ุฅูุดุงุก ุงููุฏูุฑ ุงูุงูุชุฑุงุถู ุนูุฏ ุจุฏุก ุงูุชุดุบูู
- ุชุญุฏูุซ ุตูุญุฉ ุงูุชุฑุญูุจ

### 7. ูููุงุช ุงููุณุงุนุฏุฉ
- `setup_database.py` - ุณูุฑูุจุช ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช
- `config_example.env` - ููู ุชูููู ุจูุฆู
- `MONGODB_SETUP.md` - ุฏููู ุฅุนุฏุงุฏ MongoDB
- `AUTH_GUIDE.md` - ุฏููู ุงุณุชุฎุฏุงู ูุธุงู ุงููุตุงุฏูุฉ

## ๐ ุงูููุฒุงุช ุงูุฃูููุฉ

### JWT Tokens
- **ุงูุฎูุงุฑุฒููุฉ**: HS256
- **ูุฏุฉ ุงูุตูุงุญูุฉ**: 30 ููู
- **ุงูููุชุงุญ ุงูุณุฑู**: ูุงุจู ููุชุฎุตูุต

### ุชุดููุฑ ูููุงุช ุงููุฑูุฑ
- **ุงูุฎูุงุฑุฒููุฉ**: bcrypt
- **ุงูููุญ**: ุชููุงุฆู
- **ุนุฏุฏ ุงูุฌููุงุช**: 12 (ูุงุจู ููุชุฎุตูุต)

### ุญูุงูุฉ Endpoints
- ุฌููุน endpoints ุงููุฑุถู ูุญููุฉ
- ุงูุชุญูู ูู ุตุญุฉ Token ูู ูู ุทูุจ
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ููููุฏุฉ

## ๐ ุจูุงูุงุช ุชุณุฌูู ุงูุฏุฎูู ุงูุงูุชุฑุงุถูุฉ

```
ุงุณู ุงููุณุชุฎุฏู: admin
ูููุฉ ุงููุฑูุฑ: admin123
ุงูุตูุงุญูุงุช: ูุฏูุฑ
```

โ๏ธ **ุชุญุฐูุฑ**: ูุฌุจ ุชุบููุฑ ูููุฉ ุงููุฑูุฑ ูู ุงูุฅูุชุงุฌ!

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. ุชุณุฌูู ุงูุฏุฎูู
```bash
curl -X POST "http://localhost:8000/auth/login" \
  -H "Content-Type: application/json" \
  -d '{"username": "admin", "password": "admin123"}'
```

### 2. ุงุณุชุฎุฏุงู ุงูุฑูุฒ ุงููููุฒ
```bash
curl -X GET "http://localhost:8000/patients" \
  -H "Authorization: Bearer YOUR_TOKEN_HERE"
```

### 3. ุฅูุดุงุก ูุณุชุฎุฏู ุฌุฏูุฏ
```bash
curl -X POST "http://localhost:8000/auth/register" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "newuser",
    "email": "user@example.com",
    "full_name": "ุงุณู ุงููุณุชุฎุฏู",
    "password": "password123",
    "is_admin": false
  }'
```

## ๐ง ุฅุนุฏุงุฏ MongoDB

ุฅุฐุง ูุงุฌูุช ูุดููุฉ ูู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช:

1. **ุชุดุบูู MongoDB ุจุฏูู ูุตุงุฏูุฉ** (ููุชุทููุฑ):
```bash
mongod --dbpath "C:\data\db" --noauth
```

2. **ุฃู ุฅุนุฏุงุฏ ูุตุงุฏูุฉ**:
```bash
# ูู MongoDB shell
use admin
db.createUser({
  user: "admin",
  pwd: "password",
  roles: ["userAdminAnyDatabase", "dbAdminAnyDatabase", "readWriteAnyDatabase"]
})
```

3. **ุชุญุฏูุซ ูุชุบูุฑ ุงูุจูุฆุฉ**:
```bash
set MONGODB_URL=mongodb://admin:password@localhost:27017
```

## ๐ฑ ุชุญุฏูุซ ุชุทุจูู Flutter

ูุชุญุฏูุซ ุชุทุจูู Flutter ููุนูู ูุน ูุธุงู ุงููุตุงุฏูุฉ:

### 1. ุฅุถุงูุฉ Bearer Token ููุทูุจุงุช
```dart
final token = await getStoredToken();
final response = await http.get(
  Uri.parse('$baseUrl/patients'),
  headers: {
    'Authorization': 'Bearer $token',
    'Content-Type': 'application/json',
  },
);
```

### 2. ุชุฎุฒูู ุงูุฑูุฒ ุงููููุฒ
```dart
// ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู ุงููุงุฌุญ
await storage.write(key: 'auth_token', value: response['access_token']);
```

### 3. ุฅุฏุงุฑุฉ ุงูุชูุงุก ุตูุงุญูุฉ ุงูุฑูุฒ
```dart
// ุงูุชุญูู ูู ุงูุชูุงุก ุงูุตูุงุญูุฉ ูุฅุนุงุฏุฉ ุชุณุฌูู ุงูุฏุฎูู
if (isTokenExpired(token)) {
  await refreshToken();
}
```

## ๐ก๏ธ ุงูุฃูุงู ูู ุงูุฅูุชุงุฌ

1. **ุชุบููุฑ ุงูููุชุงุญ ุงูุณุฑู**:
```python
SECRET_KEY = "your-very-secure-secret-key-here"
```

2. **ุชุญุฏูุฏ ุงููุทุงูุงุช ุงููุณููุญุฉ**:
```python
allow_origins=["https://yourdomain.com"]
```

3. **ุงุณุชุฎุฏุงู HTTPS**
4. **ุชุบููุฑ ูููุฉ ูุฑูุฑ ุงููุฏูุฑ ุงูุงูุชุฑุงุถู**
5. **ุชูุนูู ุณุฌูุงุช ุงูุฃูุงู**

## ๐ ุงููุณุงุฑุงุช ุงููุญููุฉ

ุฌููุน ุงููุณุงุฑุงุช ุงูุชุงููุฉ ุชุชุทูุจ Bearer Token:

- `GET /patients` - ูุงุฆูุฉ ุงููุฑุถู
- `POST /patients` - ุฅูุดุงุก ูุฑูุถ ุฌุฏูุฏ
- `GET /patients/{id}` - ุชูุงุตูู ูุฑูุถ
- `PUT /patients/{id}` - ุชุญุฏูุซ ูุฑูุถ
- `DELETE /patients/{id}` - ุญุฐู ูุฑูุถ
- `POST /patients/{id}/payments` - ุฅุถุงูุฉ ุฏูุนุฉ
- `GET /patients/notifications/overdue` - ุฅุดุนุงุฑุงุช ุงููุชุฃุฎุฑุงุช
- `GET /patients/upcoming-payments` - ุงูุฏูุนุงุช ุงููุงุฏูุฉ
- `GET /patients/statistics/summary` - ุงูุฅุญุตุงุฆูุงุช

## ๐ ุงููุณุงุฑุงุช ุงูุนุงูุฉ

ูุฐู ุงููุณุงุฑุงุช ูุง ุชุชุทูุจ ูุตุงุฏูุฉ:

- `GET /` - ุตูุญุฉ ุงูุชุฑุญูุจ
- `GET /health` - ูุญุต ุญุงูุฉ ุงูุชุทุจูู
- `GET /docs` - ูุซุงุฆู API
- `POST /auth/login` - ุชุณุฌูู ุงูุฏุฎูู
- `POST /auth/register` - ุชุณุฌูู ูุณุชุฎุฏู ุฌุฏูุฏ

## โ ุงูุงุฎุชุจุงุฑ

ุชู ุงุฎุชุจุงุฑ ุงููุธุงู ูุงูุชุฃูุฏ ูู:
- ุชุญููู ุงูุชุทุจูู ุจูุฌุงุญ
- ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก ูู ุงูููุฏ
- ุชูุงูู ุฌููุน ุงูููุชุจุงุช
- ุตุญุฉ ูููู ุงููููุงุช

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. **ุญู ูุดููุฉ MongoDB** (ุฑุงุฌุน `MONGODB_SETUP.md`)
2. **ุชุดุบูู ุงูุชุทุจูู** (`python -m uvicorn main:app --reload`)
3. **ุงุฎุชุจุงุฑ API** ุนุจุฑ `/docs`
4. **ุชุญุฏูุซ ุชุทุจูู Flutter**
5. **ุฅุนุฏุงุฏ ุงูุฅูุชุงุฌ**

## ๐ ุงูุฏุนู

ูููุณุงุนุฏุฉ ุฃู ุงูุงุณุชูุณุงุฑุงุช:
- ุฑุงุฌุน `AUTH_GUIDE.md` ููุชูุงุตูู ุงููุงููุฉ
- ุฑุงุฌุน `MONGODB_SETUP.md` ูุญู ูุดุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชุญูู ูู ุณุฌูุงุช ุงูุชุทุจูู ููุฃุฎุทุงุก
